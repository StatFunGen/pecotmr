% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/regularized_regression.R
\name{gbayes_rss}
\alias{gbayes_rss}
\title{Bayesian linear regression using summary statistics}
\usage{
gbayes_rss(
  stat = NULL,
  LD = NULL,
  rsids = NULL,
  nit = 100,
  nburn = 0,
  nthin = 4,
  method = "bayesR",
  vg = NULL,
  vb = NULL,
  ve = NULL,
  ssg_prior = NULL,
  ssb_prior = NULL,
  sse_prior = NULL,
  lambda = NULL,
  h2 = NULL,
  pi = 0.001,
  updateB = TRUE,
  updateG = TRUE,
  updateE = TRUE,
  updatePi = TRUE,
  adjustE = TRUE,
  nug = 4,
  nub = 4,
  nue = 4,
  mask = NULL,
  ve_prior = NULL,
  vg_prior = NULL,
  algorithm = "mcmc",
  tol = 0.001,
  nit_local = NULL,
  nit_global = NULL
)
}
\arguments{
\item{stat}{dataframe with marker summary statistics. Required: beta coefficient (b), standard error 
of the beta coefficient (seb), GWAS sample size (n). Optional: rsids, alleles (a1 and a2), 
major allele frequency (af).}

\item{LD}{is a the LD matrix corresponding to the same markers as in the stat dataframe}

\item{rsids}{is an optional character vector of rsids, provided outside of the stat dataframe}

\item{nit}{is the number of iterations}

\item{nburn}{is the number of burnin iterations}

\item{nthin}{is the thinning parameter}

\item{method}{specifies the methods used (method="bayesN","bayesA","bayesL","bayesC","bayesR")}

\item{vg}{is a scalar or matrix of genetic (co)variances}

\item{vb}{is a scalar or matrix of marker (co)variances}

\item{ve}{is a scalar or matrix of residual (co)variances}

\item{ssg_prior}{is a scalar or matrix of prior genetic (co)variances}

\item{ssb_prior}{is a scalar or matrix of prior marker (co)variances}

\item{sse_prior}{is a scalar or matrix of prior residual (co)variances}

\item{lambda}{is a vector or matrix of lambda values}

\item{h2}{is the trait heritability}

\item{pi}{is the proportion of markers in each marker variance class}

\item{updateB}{is a logical for updating marker (co)variances}

\item{updateG}{is a logical for updating genetic (co)variances}

\item{updateE}{is a logical for updating residual (co)variances}

\item{updatePi}{is a logical for updating pi}

\item{adjustE}{is a logical for adjusting residual variance}

\item{nug}{is a scalar or vector of prior degrees of freedom for prior genetic (co)variances}

\item{nub}{is a scalar or vector of prior degrees of freedom for marker (co)variances}

\item{nue}{is a scalar or vector of prior degrees of freedom for prior residual (co)variances}

\item{mask}{is a vector or matrix of TRUE/FALSE specifying if marker should be ignored}

\item{ve_prior}{is a scalar or matrix of prior residual (co)variances}

\item{vg_prior}{is a scalar or matrix of prior genetic (co)variances}

\item{algorithm}{is the algorithm to use. Should take on values ("mcmc", "em-mcmc")}

\item{tol}{is tolerance, i.e. convergence criteria used in gbayes}

\item{nit_local}{is the number of local iterations}

\item{nit_global}{is the number of global iterations}
}
\value{
Returns a list structure including
\item{bm}{vector of posterior means for marker effects}
\item{dm}{vector of posterior means for marker inclusion probabilities}
\item{vbs}{scalar or vector (t) of posterior means for marker variances}
\item{vgs}{scalar or vector (t) of posterior means for genomic variances}
\item{ves}{scalar or vector (t) of posterior means for residual variances}
\item{pis}{vector of probabilites for each mcmc iteration}
\item{pim}{posterior distribution probabilities}
\item{r}{vector of residuals}
\item{b}{vector of estimates from the final mcmc iteration}
\item{param}{a list current parameters (same information as item listed above) 
             used for restart of the analysis}
\item{stat}{matrix (mxt) of marker information and effects used for genomic risk scoring}
\item{method}{the method used}
\item{mask}{which loci were masked from analysis}
\item{conv}{dataframe of convergence metrics}
\item{post}{posterior parameter estimates}
\item{ve}{mean residual variance}
\item{vg}{mean genomic variance}
}
\description{
This function is adapted from those written by Peter Sørensen in the qgg package.
The following prior distributions are provided:

Bayes N: Assigning a Gaussian prior to marker effects implies that the posterior means are the 
BLUP estimates (same as Ridge Regression).

Bayes L: Assigning a double-exponential or Laplace prior is the density used in 
the Bayesian LASSO

Bayes A: similar to ridge regression but t-distribution prior (rather than Gaussian) 
for the marker effects ; variance comes from an inverse-chi-square distribution instead of being fixed. Estimation 
via Gibbs sampling. 

Bayes C: uses a “rounded spike” (low-variance Gaussian) at origin many small 
effects can contribute to polygenic component, reduces the dimensionality of 
the model (makes Gibbs sampling feasible). 

Bayes R: Hierarchical Bayesian mixture model with 4 Gaussian components, with 
variances scaled by 0, 0.0001 , 0.001 , and 0.01 .
}
