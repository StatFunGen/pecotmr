% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mrmash_wrapper.R
\name{mrmash_wrapper}
\alias{mrmash_wrapper}
\title{mr.mash wrapper}
\usage{
mrmash_wrapper(
  X,
  Y,
  prior_data_driven_matrices,
  prior_grid,
  nthreads = 2,
  prior_canonical_matrices = FALSE,
  standardize = TRUE,
  update_w0 = TRUE,
  w0_threshold = 1e-08,
  update_V = TRUE,
  update_V_method = "full",
  B_init_method = "enet",
  max_iter = 5000,
  tol = 0.01,
  verbose = FALSE
)
}
\arguments{
\item{X}{n x p matrix of genotype, where n is the total number of individuals and p denotes
the number of SNPs.}

\item{Y}{n x r matrix of residual for expression, where n is the total number of individuals 
and r is the total number of conditions (tissue/cell-types).}

\item{prior_data_driven_matrices}{A list of data-driven covariance matrices.}

\item{prior_grid}{a vector of scaling factors to be used in fitting mr.mash model.}
}
\value{
A mr.mash fit, stored as a list with some or all of the
following elements:

\item{mu1}{p x r matrix of posterior means for the regression
  coeffcients. }

\item{S1}{r x r x p array of posterior covariances for the
  regression coeffcients. }

\item{w1}{p x K matrix of posterior assignment probabilities to the
  mixture components. }
  
\item{V}{r x r residual covariance matrix. }

\item{w0}{K-vector with (updated, if \code{update_w0=TRUE}) prior mixture weights, each 
 associated with the respective covariance matrix in \code{S0}}.
  
\item{S0}{r x r x K array of prior covariance matrices
  on the regression coefficients. }

\item{intercept}{r-vector containing posterior mean estimate of the
  intercept.}

\item{fitted}{n x r matrix of fitted values.}

\item{G}{r x r covariance matrix of fitted values.}

\item{pve}{r-vector of proportion of variance explained by the covariates.}

\item{ELBO}{Evidence Lower Bound (ELBO) at last iteration.}

\item{progress}{A data frame including information regarding
  convergence criteria at each iteration.}
  
\item{converged}{\code{TRUE} or \code{FALSE}, indicating whether
  the optimization algorithm converged to a solution within the chosen tolerance
  level.}

\item{elapsed_time}{computation runtime for fitting mr.mash. }
  
\item{Y}{n x r matrix of responses at last iteration (only relevant when missing values
  are present in the input Y).}
}
\description{
Take precomputed prior grid and mixture prior to compute weights with mr.mash
}
\examples{
###Set seed
set.seed(123)
prior_grid <- runif(17,0.00005,0.05)

#simulate X and Y, sample id, snp id
sample_id <- paste0("P000", str_pad(1:400, 3, pad = "0"))
X<- matrix(sample(0:2, size=n*p, replace=TRUE, prob=c(.65,.30,.05)), nrow=n)
rownames(X) <- sample_id
colnames(X) <- paste0("rs", sample(10000:100000, p)) #snp names
tissues <- c('Adipose Tissue','Muscle Tissue', 'Brain Tissue','Liver Tissue','Kidney Tissue',
'Heart Tissue','Lung Tissue')
Y <- matrix(runif(n*r,-2,2), nrow=n)
Y <- scale(Y)
colnames(Y) <- tissues
rownames(Y) <- sample_id 


set.seed(Sys.time())
components <- c('XtX','tFLASH_default','FLASH_default','tFLASH_nonneg','FLASH_nonneg','PCA')

prior_data_driven_matrices <- list()
for (i in components){
   A <- matrix(runif(r^2)*2-1, ncol=r) 
   cov <- t(A) \%*\% A
   colnames(cov) <- tissues
   rownames(cov) <- tissues
   prior_data_driven_matrices[[i]]<- cov
   }

#fit mr.mash without cross validation
res <- mrmash_wrapper(X=X, Y=Y, prior_data_driven_matrices=prior_data_driven_matrices, prior_grid=prior_grid)


}
