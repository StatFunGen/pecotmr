% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/twas_scan.R
\name{twas_scan}
\alias{twas_scan}
\title{Calculate the pvalue and zscore of each gene using precomputed weights}
\usage{
twas_scan(weights_path, region, GWAS_data, LD_block_path)
}
\arguments{
\item{weights_path}{a data frame with columns "ID" and "path", "ID" is the gene name, and "path" is the susie result path of the corresponding gene.}

\item{region}{a data frame with columns "chr", "start", "end", and "ID", "chr" is the chromosome of gene, "start" and "end" are the position, "ID" is the gene name.}

\item{GWAS_data}{a data frame of GWAS summary statistics with columns "chr","pos","A1","A2","beta","se" and "z".}

\item{LD_block_path}{a data frame of LD block matrix path with columns "chr","start","end" and "path"}
}
\value{
A list 
\describe{
\item{twas_z_format}{the input format of twas_z function with the columns "variants_name","gene_name","chr","beta"."se","z","susie_weights","lasso_weights","enet_weights" and "mr_ash_weights".}
\item{gene_weights_pq}{twas_z function results with pvalue, qvalue and zscore}
\item{outcome_QC}{the GWAS summary statistics of the outcome after QC (mainly accounting for allele flip)}
}
}
\description{
there are five steps:1) use allele_qc function to QC the GWAS summary statistics with xQTL weights;
2) load the corresponding LD block within the region (start and end) of gene;
3) use twas_z function to calculate TWAS results (pvalue and zscore) from multiple methods of calculating xQTL weights.
}
