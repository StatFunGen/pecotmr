% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/quantile_twas_weight.R
\name{quantile_twas_weight_pipeline}
\alias{quantile_twas_weight_pipeline}
\title{Quantile TWAS Weight Pipeline}
\usage{
quantile_twas_weight_pipeline(
  X,
  Y,
  Z = NULL,
  maf = NULL,
  region_id = "",
  ld_reference_meta_file = NULL,
  twas_maf_cutoff = 0.01,
  quantile_qtl_tau_list = seq(0.05, 0.95, by = 0.05),
  quantile_twas_tau_list = seq(0.01, 0.99, by = 0.01)
)
}
\arguments{
\item{X}{Matrix of genotypes}

\item{Y}{Matrix or vector of phenotypes}

\item{Z}{Matrix of covariates (optional)}

\item{maf}{Vector of minor allele frequencies (optional)}

\item{region_id}{Name of the region being analyzed}

\item{quantile_qtl_tau_list}{Vector of quantiles for QTL analysis}

\item{quantile_twas_tau_list}{Vector of quantiles for TWAS analysis}
}
\value{
A list containing various results from the TWAS weight pipeline:
\itemize{
  \item qr_screen_pvalue_df: Data frame with QR screening results: pavlue, qvalue and zscore.
  \item message: Any informational or warning messages.
  \item twas_variant_names: Names of variants used in TWAS weight calculation.
  \item rq_coef_df: Data frame with quantile regression coefficients.
  \item twas_weight: Matrix of TWAS weights.
  \item pseudo_R2: Vector of pseudo R-squared values.
  \item quantile_twas_prediction: Matrix of TWAS predictions.
}
}
\description{
Quantile TWAS Weight Pipeline
}
\details{
The function performs the following steps:
1. QR screening to identify significant SNPs.
2. Filtering of highly correlated SNPs.
3. LD clumping and pruning(use filtered SNPs from step 1).
4. Calculation of QR coefficients for selected SNPs(use filtered SNPs from step 3).
5. Calculation of TWAS weights and pseudo R-squared values(use filtered SNPs from step 2).
}
\examples{
# Example usage:
# X <- matrix of genotypes
# Y <- vector of phenotypes
# Z <- matrix of covariates
# results <- quantile_twas_weight_pipeline(X, Y, Z, region_id = "GeneA")

}
